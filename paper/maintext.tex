\documentclass[a4paper,11pt]{article}

\usepackage{graphicx,epsfig,subfig}
\usepackage{fancyhdr,fancybox}
\usepackage{indentfirst}
\usepackage{titlesec}
\usepackage{verbatim}
\usepackage[titletoc,title]{appendix}
\usepackage[sort&compress, numbers]{natbib}
\usepackage{array,dcolumn,tabularx}
\usepackage{setspace}
\usepackage{geometry}
\usepackage{extarrows,chemarrow,xypic}
\usepackage{lineno}
\usepackage{microtype}
\usepackage{xcolor}

\usepackage{latexsym}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{bm}
\usepackage{arydshln}
\usepackage{relsize}
\usepackage{hyperref}

\newcommand{\paperfont}{\fontsize{11pt}{1.2\baselineskip}\selectfont}
\geometry{top=1in,bottom=1in,left=1in,right=1in}
\parindent 4ex


\begin{document}

\theoremstyle{definition}
\makeatletter
\thm@headfont{\bf}
\makeatother
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem{remark}{Remark}
\newtheorem{proposition}{Proposition}

\lhead{}
\rhead{}
\lfoot{}
\rfoot{}

\renewcommand{\refname}{References}
\renewcommand{\figurename}{Fig.}
\renewcommand{\tablename}{Table}
\renewcommand{\proofname}{Proof}

\newcommand{\diag}{\mathrm{diag}}
\newcommand{\tr}{\mathrm{tr}}
\newcommand{\Enum}{\mathbb{E}}
\newcommand{\Pnum}{\mathbb{P}}
\newcommand{\Rnum}{\mathbb{R}}
\newcommand{\Cnum}{\mathbb{C}}
\newcommand{\Znum}{\mathbb{Z}}
\newcommand{\Nnum}{\mathbb{N}}
\newcommand{\abs}[1]{\left\vert#1\right\vert}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\norm}[1]{\left\Vert#1\right\Vert}
\newcommand{\bx}{\mathbf{x}}

\title{Some mathematical aspects of Anderson localization: landscape, boundary probability, multimodality and phase transition}
\author{Chen Jia$^{1}$,\;\;\;Ziqi Liu$^{1}$,\;\;\;Zhimin Zhang$^{1,2,*}$\\
\footnotesize $^1$ Beijing Computational Science Research Center, Beijing 100193, China \\
\footnotesize $^2$ Department of Mathematics, Wayne State University, Detroit, Michigan 48202, U.S.A.\\
\footnotesize Email: zmzhang@csrc.ac.cn}
\date{}
\maketitle
%\tableofcontents
\thispagestyle{empty}

\paperfont

\begin{abstract}
{\color{red} unfinished} \\

\noindent
\textbf{Keywords}:

%60J27, 60J28, 92C40, 78A70, 92B05
\end{abstract}

\section{Introduction}

{\color{red} unfinished}

\section{Model and localization landscape}

\subsection{Model}

Here we consider high-dimensional \emph{Anderson localization} for the quantum states of the following stationary Schrodinger equation with a Dirichlet, Neumann, or Robin boundary condition (Anderson's original paper \cite{chen2004markov} considered a tight-binding model which can be viewed as the discretization of the continuous model studied here):
\begin{equation}\label{anderson}
\left\{
\begin{split}
& -\triangle u + K V u = \lambda u, \quad \textrm{in} \; \Omega, \\
& \quad g \frac{\partial u}{\partial n} + h u = 0, \quad \textrm{on} \; \partial  \Omega,
\end{split}
\right.
\end{equation}
where $H = -\triangle + K V$ is the Hamiltonian with $V = V(x)$ being the disordered potential, $\lambda$ is an energy level (eigenvalue), $u = u(x)$ is the associated quantum state (eigenmode), $K > 0$ is a constant called the degree of randomness. The domain $\Omega = [0,1]^d$ is the $d$-dimensional unit hypercube with each side being divided uniformly into $N$ intervals. In this way, the hypercube $\Omega$ is divided into $N^d$ smaller hypercubes of the same size. In each smaller hypercube $\Omega_k$, the potential $V$ is a constant with its value being sampled from a given probability distribution, which is often chosen as the Bernoulli distribution
\begin{equation}\label{bernoulli}
\Pnum(V|_{\Omega_k} = 0) = 1-p, \quad \Pnum(V|_{\Omega_k} = 1) = p,
\end{equation}
or the uniform distribution
\begin{equation}\label{uniform}
\Pnum(a \leq V|_{\Omega_k} \leq b) = \frac{1}{b-a}, \quad 0 \leq a < b \leq 1.
\end{equation}
The values of the potential $V$ in these hypercubes are assumed to be independent of each other.

The boundary condition of our model is rather general with $g \geq 0$ being a given constant, with $h = h(x) \geq 0$ being a given nonnegative function on $\partial \Omega$ and with $n = n(x)$ being the outward pointing unit normal vector field on $\partial \Omega$. If $g = 0$ and $h = 1$, then it reduces to the Dirichlet boundary condition; if $g = 1$ and $h = 0$, then it reduces to the Neumann boundary condition; if $g = 1$ and $h \neq 0$, then it reduces to the Robin boundary condition.

In fact, the above model can be generalized to a more complicated model as follows:
\begin{equation}\label{eigenproblem}
\left\{
\begin{split}
& - L u + K V u = \lambda u, \quad\textrm{in}\;\Omega, \\
& \quad g \frac{\partial u}{\partial n} + h u = 0, \quad \textrm{on} \; \partial \Omega,
\end{split}
\right.
\end{equation}
where
\begin{equation}\label{operator}
L = \frac{1}{2} \sum_{i,j=1}^{d} a^{ij}(x) \partial_{ij} + \sum_{i=1}^{d} b^i(x) \partial_i
\end{equation}
is an arbitrary second-order elliptic differential operator, $V = V(x)$ is an arbitrary stochastic potential and $\Omega \subset \Rnum^d$ is an arbitrary open bounded domain. In the following, we develop our theory for the general model \eqref{eigenproblem} but carry out all numerical simulations for the simpler model \eqref{anderson}.

\subsection{Localization landscape and the Filoche-Mayboroda inequality}

A recent theory \cite{filoche2012universal} has shown that under the Dirichlet boundary condition ($g = 0$ and $h = 1$), the precise spatial location of the eigenmodes for the eigenvalue problem \eqref{eigenproblem} can be predicted using the solution of an associated Dirichlet problem
\begin{equation}\label{landDirichlet}
\left\{
\begin{split}
& -L w + K V w = 1, \quad \textrm{in} \; \Omega, \\
& \quad w = 0, \quad \textrm{on} \; \partial \Omega,
\end{split}
\right.
\end{equation}
where the solution $w = w(x)$ is called the localization landscape. In fact, the theory in \cite{filoche2012universal} is developed for symmetric elliptic operators and the Dirichlet boundary condition using the Green's function of the problem. Here we define a similar localization landscape for general non-symmetric elliptic operators and more complicated boundary conditions using a probabilistic approach.

The key step of the probabilities approach is to find the probabilistic representation of the eigenvalue problem \eqref{eigenproblem}. To this end, recall that given the bounded domain $\Omega \subset \Rnum^d$ and the outward pointing unit normal vector field $n = n(x)$ on $\partial \Omega$, the operator $L$ given in \eqref{operator} is the infinitesimal generator of a reflecting diffusion process $X = (X_t)_{t \geq 0}$ with drift $b = (b^i)$ and diffusion matrix $a = (a^{ij})$, which is the solution to the Skorokhod stochastic differential equation:
\begin{equation}\label{reflecting}
dX_t = b(X_t) dt + a^{1/2}(X_t) d B_t - g n(X_t) d F_t, \quad Y_0 = x\in\Omega,
\end{equation}
where $B = (B_t)_{t\geq 0}$ is a $d$-dimensional standard Brownian motion and $F_t$ is a continuous nondecreasing process that increases only when $X_t \in \partial \Omega$ \cite{1998Diffusions}. In particular, if $L = \triangle$ is the Laplace operator, then the solution of the Skorokhod equation \eqref{reflecting} is a reflecting Brownian motion. It can be proved that when $g > 0$, the reflecting diffusion $X_t$ can never exit the domain $\Omega$, once $X_t$ touches $\partial \Omega$, it will be reflected into $\Omega$ again because of the random force $F_t$. With the aid of the reflecting diffusion, it can be shown that the solution of the eigenvalue problem \eqref{eigenproblem} has the following probabilistic representation (see Appendix \ref{appA} for the proof):
\begin{equation}\label{probeigen}
u(x) = \lambda \Enum_x \int_{0}^{\infty} u(X_t) e^{\int_{0}^{t} h(X_s) d F_s - \int_{0}^{t} K V(X_s) ds} dt.
\end{equation}
where $\Enum_x$ denotes the conditional expectation given that $X_0 = x$. For the eigenvalue problem \eqref{eigenproblem}, we define its \emph{localization landscape} $w = w(x)$ to be the solution of the following boundary value problem:
\begin{equation}\label{landscape}
\left\{
\begin{split}
& - L w + K V w = 1 \quad \textrm{in} \; \Omega, \\
& \quad g \frac{\partial w}{\partial n} + h u = 0 \quad \textrm{on} \; \partial \Omega.
\end{split}
\right.
\end{equation}
Note that the boundary value problem \eqref{landscape} is obtained by setting the right-hand side of the eigenvalue problem \eqref{eigenproblem} to be the constant $1$. Similarly, the landscape $w$ also has a probabilistic representation, which is given by
\begin{equation}\label{probland}
w(x) = \Enum_x \int_{0}^{\infty} e^{\int_{0}^{t} h(X_s) d F_s - \int_{0}^{t} KV(X_s) ds} dt.
\end{equation}
The probabilistic representations \eqref{probeigen} and \eqref{probland} are closely related. If we normalize the eigenmode $u$ such that $\|u\|_\infty = 1$, then we obtain the \emph{Filoche-Mayboroda inequality}
\begin{equation*}
|u(x)| \leq |\lambda| \cdot |w(x)| \quad \forall \; x \in \Omega.
\end{equation*}
This inequality shows that the eigenmode $u$ must be small at those points where the landscape $w$ is small. Therefore, the eigenmode of the eigenvalue problem \eqref{eigenproblem} can only be localized to those regions where the landscape is large.

From the Filoche-Mayboroda inequality, we can obtain
\begin{equation*}
\frac{|u(x)|}{|\lambda|} \leq |w(x)| \quad \forall \; x \in \Omega.
\end{equation*}
Fig. \ref{fig1}(a) illustrates the landscape $|w|$ and the first four eigenmodes $|u| / |\lambda|$ obtained by solving problem \eqref{eigenproblem} and \eqref{landscape} in the one-dimensional case. It can be seen from the figure that the Filoche-Mayboroda inequality indeed provides an accurate upper bound for eigenmodes. Furthermore, the localization positions of eigenmodes are perfectly predicted by the peak positions of the landscape.

In this paper, systems are simulated using the spectral element method instead of ordinary finite element method (FEM) or finite difference method (FEM). In the spectral element method, Legendre polynomials are used as basis to approximate the solution. Ordinary FDM or FEM can only get second-order convergence $\mathcal{O}(h^{-2})$, while the spectral element method can achieve exponential convergence $\mathcal{O}(e^{-M})$ on these problems. Exponential convergence order makes the simulation more accurate. In addition, spectral element method has less computational costs than others. Matrix size in spectral element method is $\mathcal{O}(M^2 N^2)$, which make it possible for us to simulate some large-scale systems.

\subsection{Valley lines}

In one-dimensional cases, the local minima of the landscape naturally divide the domain $\Omega$ into some intervals. These intervals correspond to the subdomains where eigenmodes may localize. However, it is not obvious that how to describe the subdomains in higher-dimensional cases. To solve this problem, \emph{valley lines} are proposed in \cite{filoche2012universal}. The watershed algorithm proposed in \cite{Soille1990Determining} can find the ridges of a high-dimensional function. The algorithm was originally used for image segmentation but it is helpful in calculating the valley lines. For the two-dimensional case, we apply the watershed algorithm to the reversed landscape to obtain the valley lines. The valley lines connect the local minima and the saddle points of the landscape and separate the whole domain $\Omega$ into several subdomains. Along the valley lines, values of the landscape are expected to be small. According to the Filoche-Mayboroda inequality, the eigenmode $u$ must be small along the valley lines, thus, all eigenmodes should be restricted to one or some of these subdomains. For higher-dimensional cases, valley lines will become hypersurfaces and the results are similar.

Fig. \ref{fig1}(b),(c) illustrate the landscape, eigenmodes and valley lines for a two-dimensional problem with the Neumann boundary condition. It can be seen from the figure that the valley lines separate the peaks of eigenmodes properly in (c).

As shown in Fig. \ref{fig1}(c), under the Neumann boundary condition, some eigenmodes (like eigenmodes in the order of $1$, $2$ and $4$) may localize to the boundary. The boundary value of these eigenmodes are very large, even the maxima of these eigenmodes may appear on the boundary. This phenomenon will never appear under the Dirichlet boundary condition.

\begin{figure}
\centering
\includegraphics[width=\linewidth]{Fig1}
\caption{(a) The landscape and first four eigenmodes obtained by simulating the system \eqref{eigenproblem} and \eqref{landscape} with the Neumann boundary condition. The black line denotes the landscape and the colored lines are the eigenmodes. (b) The landscape and corresponding valley lines in a two-dimensional case. Red lines denote the valley lines. (c) The first four eigenmodes and corresponding valley lines, white numbers denote the rank of eigenmodes. Parameters are chosen as $K = 8000, N = 30$ for the one-dimensional case and $K = 8000, N = 20$ for the two-dimensional case. The potential $V$ is sampled from uniform distribution. }
\label{fig1}
\end{figure}

\subsection{Limit behavior}

Next, we focus on the limit behavior of the eigenmodes when the degree of randomness $K$ is very large. For simplicity, we assume that the potential function $V$ restricted to each sub-hypercube has the Bernoulli distribution \eqref{bernoulli}, which can only take the value of $0$ or $1$. Let
\begin{equation*}
D = \{x \in \Omega: V(x) = 0\}
\end{equation*}
denote the collection of sub-hypercubes at which the potential vanishes. We firstly consider the behavior of eigenmodes outside $D$. Let $x$ be the initial value of the reflecting diffusion $X_t$ solving the Skorokhod equation \eqref{reflecting}. When $x \notin D$, we have $V(X_s) = 1$ when $s$ is small, which implies that
\begin{equation*}
\int_{0}^{t} V(X_s) ds > 0, \quad \forall \; t > 0.
\end{equation*}
It thus follows from the probabilistic representation \eqref{probeigen} and the dominated convergence theorem that
\begin{equation}\label{largeK}
\lim_{K \rightarrow \infty} u(x) = 0, \quad \forall \; x \notin D.
\end{equation}
This shows that all eigenmodes must vanish outside $D$ in the limit of $K \rightarrow \infty$. In other words, when the degree of randomness $K$ is very large, the eigenmodes can only localize in the subdomain at which the potential attains its minimum. This means that the quantum states will converge to the position with the lowest potential energy.

We next focus on the behavior of eigenmodes inside $D$. Clearly, $D$ can be decomposed as the disjoint union of several connected components:
\begin{equation*}
D = D_1 \cup D_2 \cup \cdots \cup D_N.
\end{equation*}
In the limit of $K\rightarrow\infty$, since the potential vanishes in $D$, the eigenmode $u$ must satisfy the following local eigenvalue problem in each subdomain $D_k$:
\begin{equation}\label{subdomain}
\left\{
\begin{split}
& - L u = \lambda u \quad \textrm{in}\;\;\Omega, \\
& \quad g \frac{\partial u}{\partial n} + h u = 0 \quad \textrm{on}\;\;\partial D_k \cap \partial \Omega, \\
& \quad u = 0 \quad \textrm{on}\;\;\partial D_k \setminus \partial \Omega.
\end{split}
\right.
\end{equation}
Therefore, in the limit of $K \rightarrow \infty$, the spectrum of the Hamiltonian $H = - L + K V$ is composed of the local eigenvalues of the operator $-L$ in each subdomain $D_k$. If an eigenvalue of $H$ coincides with one of the local eigenvalues of $-L$ in $D_k$, then the corresponding eigenmode will be localized in $D_k$; conversely, if an eigenvalue of $H$ coincides with neither one of the local eigenvalues of $-L$ in $D_k$, then the corresponding eigenmode will not be localized in $D_k$. Based on the above discussion, if multiple subdomains $D_{k_1}, \cdots , D_{k_r}$ share a common local eigenvalue, then the corresponding eigenmode will have multiple peaks and the system will display \emph{multimodality}. In this case, there are more than one eigenvalue sharing a common value and the corresponding eigenmodes are composed of the local eigenmodes of subdomains.

Fig. \ref{fig2}(a) illustrates the potential, landscape and eigenmodes for a one-dimensional problem when $K$ is very large. It can be seen from the figure that the peaks of landscape and eigenmodes only appear in the subdomains in which $V = 0$. Fig. \ref{fig2}(b),(c) illustrates the potential and valley lines for a two-dimensional problem under different values of $K$. When $K$ is small, the subdomains predicted by the valley lines have no significant relationship with $V$. But for sufficient large $K$, the connected components $D_1, \cdots, D_k$ in which $V = 0$ are exactly separated by the valley lines. 

\begin{figure}
\centering
\includegraphics[width=\linewidth]{Fig2}
\caption{(a) The potential, landscape and first four eigenmodes of a one-dimensional problem with the Neumann boundary condition. The gray back ground denotes that $V = 1$ in the subdomain and the white background denotes $V = 0$. The black line denotes the landscape and the colored lines denote the eigenmodes. Parameters are chosen as $K = 10^4$ (b), (c) The potential and valley lines in a two-dimensional problem with the Neumann boundary condition. The yellow parts denote that $V$ in the subdomains are $1$ and the blue parts denote $0$. Red lines denote the valley lines.}
\label{fig2}
\end{figure}

\section{Probability of localization to the boundary}

In the previous discussion, we develop our theory for the general model \eqref{eigenproblem} but in the following, we only focus on the model \eqref{anderson}.

\subsection{Localization to the boundary}

As shown in Fig. \ref{fig1} (a) and (c), different with the Dirichlet boundary condition, eigenmodes of the problem with Neumann or Robin boundary condition may localize to the boundary, such as eigenmodes number $2$ in (a) and eigenmodes number $1$, $2$ and $4$ in (c). If the value of the eigenmode is very large in a certain area, we call that the eigenmode localize on that area. When an eigenmode localize to the boundary, its boundary value must be very large and the maxima of the eigenmode may appear on the boundary.

In following discussion, the eigenmode is normalized satisfying $\max_{x \in \Omega} |u(x)| = 1$. In the one-dimensional case, we can define the eigenmode \emph{localize to the boundary} if it satifies
\begin{equation}\label{probbound}
\max\{|u(0)|, |u(1)|\} > 0.5.
\end{equation}
In the two-dimensional case, we can define the eigenmode \emph{localize to the edge} if it satifies
\begin{equation}\label{probedge}
\max_{x \in \partial \Omega} |u(x)| > 0.5,
\end{equation}
and \emph{localize to the corner} if it satifies
\begin{equation}\label{probcorner}
\max\{|u(0,0)|, |u(0,1)|, |u(1,1)|, |u(1,0)|\} > 0.5.
\end{equation}

Since the potential $V$ is randomly sampled from the Bernoulli distribution, the eigenmodes sometimes localize to the boundary and sometimes they do not. For simplicity, we only consider the first eigenmode. The probability of the first eigenmode localize to the boundary, edge and corner is defined as $P_b$, $P_e$ and $P_c$ respectively. Under the Dirichlet boundary condition, $P_b$, $P_e$ and $P_c$ are all $0$. But under Robin and Neumann boundary conditions, $P_b$, $P_e$ and $P_c$ are positive numbers depends on the parameter $p$, $K$ and $h$.

Fig. \ref{fig3}(a)-(c) show the variation of probability $P_b$, $P_e$ and $P_c$ with the parameter $h$, $p$ and $K$ for the Robin boundary conditions respectively. As shown in Fig. \ref{fig3}(a), if we take the limit $h \rightarrow \infty$, then the Robin boundary condition reduces to the Dirichlet one and all the probability will decrease to $0$. In Fig. \ref{fig3}(b), for small $h$, when the degree of randomness $K$ is small, the system will reduce to a Laplacian eigenvalue problem, so the first eigenmode of the system is almostly consant. Under the definition \eqref{probbound}, \eqref{probedge} and \eqref{probcorner}, an eigenmode with constant value localize to the boundary. With the increasing of K, the localization effect begin to appear and the probility of localization to the boundary decreses. But in Fig. \ref{fig3}(c), the realtionship between the probability and the parameter $p$ is complicated. A theoretical expression will be discussed next.

\subsection{The tendency of boundary localization}

As shown in Fig. \ref{fig1} (a) and (c), eigenmodes with Neumann boundary condition are more likely to localize to the boundary. For example, in the first four eigenmodes, there are three eigenmodes localize to the boundary in Fig. \ref{fig1}(c). Here we give some explanation for this phenomon when $K$ is large.

For large $K$, the eigenmode and corresponding eigenvalue localizing in the subdomain $D_k$ can be approximately regarded as solutions of the local eigenvalue problem \eqref{subdomain}. Furthermore, the first eigenmode of problem \eqref{anderson} should localize in the subdomain $D_k$ on which the local eigenvalue is the smallest in all connected branches of $D$. For the one-dimensional case and the Dirichlet boundary condition, the first eigenmode will localize in the longest subdomain. But for other boundary conditions, the discussion of the local eigenvalue problem \eqref{subdomain} on the boundary becomes more complicated. We propose the \emph{extended subdomain} to simplify the discussion.

Consider the problem \eqref{subdomain} with the Neumann boundary condition on $\partial D_k \cap \partial \Omega$. According to the proof given in Appendix \ref{appD}, the smallest eigenvalue of the problem \eqref{subdomain} is equal to the smallest Dirichlet eigenvalue on $D_k^{(e)}$ which can be obtained $D_k$ through mirror symmetry. Fig. \ref{fig3}(d) illustrates the first eigenmode on $D_k$ and $D_k^{(e)}$ for a simple one-dimensional case.

Precisely, the extended subdomain can be defined as follows. When $D_k \cup \partial \Omega = \phi$, the extended subdomain $D_k^{(e)}$ is the same as $D_k$, when $D_k \cup \partial \Omega \neq \phi$, all the extended subdomain $D_k^{(e)}$ can be obtained from $D_k$ through mirror symmetry along the boundary $\partial \Omega$. Perticuliarly, for two-dimensioinal case, when the subdomain is on the corner, there are two edges near the subdomain, thus the extended subdomain should be mirror symmetirc about both edges. Fig. \ref{fig3} (e), (f) illustrate the potential and corresponding extended subdomains in the one-dimensional and two-dimensional cases respectively.

With the help of the extended subdomain, we can transform all the local eigenvalue problems into Laplacian eigenvalue problems with the Dirichlet boundary condition in extended subdomains. According to the previous discussions, the first eigenmode of problem \eqref{anderson} will localize to the extended subdomain on which the Laplacian eigenvalue with the Dirichlet boundary condition is the smallest. Especially, in the one-dimensional case, the first eigenmode will localize in the longest extended subdomain. If the longest two extended subdomains are same in length, the first eigenmode will display multimodality.

It can be seen in the Fig. \ref{fig3} (e), (f) that the extended subdomains on the boundary are more likely to have larger size. For example, in the two-dimensional case, when the subdomain is on the edge, the area of the cprresponding extended subdomain will be twice as much as before, and when the subdomain is on the corner, the area will be four times as much as before. Further more, the extended subdoamins near the boundary have better symmetry. Then the local eigenvalue of the problem \eqref{subdomain} on these subdomains are more likely smaller. Then the first eigenmode are more likely localize to the boundary.

\begin{figure}
\centering
\includegraphics[width=\linewidth]{Fig3}
\caption{(a), (b) and (c) Simulation results of the probability of localization to the boundary. Default parameters are chosen as $K = 10^3, h = 0.01, p = 0.5， N= 50$ if not mentioned. (d) The first eigenmode of the Laplacian eigenvalue problem on $D$ and $D^{(e)}$. (e), (f) The potential and extended subdomains in one-dimensional and two-dimensional case respectively. Blue parts denote subdomains on which $V = 0$ and yellow parts denote $V = 1$. Extended subdomains $D^{(e)}$ are surrounded by red lines. (g) Simulation results and theoretical predictions of the probability of localization to the boundary for the one-dimensional case. Blue crosses denote the simulation result of the probability $P_b$ under different values of $p$, red crosses denote the frequency of the event "the longest extended subdomain locates on the boundary" in the simulation and the black line denotes the theoretical prediction of $P_b$ from equation \eqref{bdprob}. Parameters are chosen as $K = 5 \times 10^4, h = 0.01, N = 50$. We randomly generate the potential $1000$ times on each point and calculate the mean value of the samples as the results of the probability.}
\label{fig3}
\end{figure}

\subsection{A theoretical result for the one-dimensional case}

The probability of localization to the boundary in general case is hard to be obtained theoretically. Here, we only calculate the theoretical expression of the probability for one-dimensional problems with the Robin boundary condition and sufficient small $h$ and large $K$.

In the one-dimensional case, the whole interval $[0, 1]$ is divided uniformly into $N$ subintervals. In each subinterval, the potential $V$ is constant with its value being sampled from the Bernoulli distribution independently. Then the whole interval consists of subintervals taking values $0$ and $1$ alternately. The length of these subintervals approximately follow the geometric distribution. For sufficient small $h$, the boundary condition will reduce to the Neumann one. For sufficient large $K$, the probability that the first eigenmode localizes to the boundary is equal to the probability of the event that the longest extended subdomain locates on the boundary. We can obtain that the probability is (see Appendix \ref{appB} for the detailed derivation)
\begin{equation}\label{bdprob}
P_b = q^2 p^2 \sum_{k=1}^{\infty} q^{k-2} \sum_{n=1}^{k-1} (1 - q^{2 \max\{k-n,n\}-1})^{M-2} + p q^2 \sum_{n=1}^{\infty} (1 - p^{2 n-1})^{M-2} p^{n-1}.
\end{equation}
The relationship between the probability $P_b$ and the parameter $p$ is extremely complex. In this paper, we give an theretically result of the complex relation in a simple case of one-dimension.

To test the accuracy of our approximate analytical expression, we compare the theoretical prediction given in \eqref{bdprob} with numerical simulations. The results are illustrated in Fig. \ref{fig3}(g). The theoretical prediction is in perfect agreement with the simulation.

In Fig. \ref{fig3}(g), $P_b$ decreases with parameter $p$ when $p<0.8$ and performs abnormal near $p=0.9$. When $p$ is near $0.2$, $P_b$ may increase to $0.5$, which means half of the eigenmodes may lacalize to the boundary. The boundary localization is a common phenomon when $p$ is small.

Here we choose the parameter $h$ to be small but not $0$ to avoid the multimodality which will be metioned latter. In the simulations, when $h$ is small but not $0$, if the longest two extended subdomains have the same length but only one of them locates on the boundary, then the first eigenmode will not localize to the boundary. This can help us to avoid some complicated discussions.

%\textcolor{red}{unfinished, we need more disscussion about why non-zero $h$ can avoid the multimodality.}

\section{Multimodality}

As mentioned earlier, for a sufficient large $K$, the eigenmode problem \eqref{anderson} can be divided into some local eigenvalue problems \eqref{subdomain} on corresponding subdomains. If multiple subdomains share a common local eigenvalue, then the corresponding eigenmodes will have multiple peaks and all the corresponding eigenvalues are equal. This phenomenon is called \emph{multimodality}. Precisely, when more than one eigenvalues are equal, the corresponding eigenmodes will form a eigenspace. Each linear combination of these eigenmodes is also a eigenmode corresponds to the eigenvalue. We say the eigenmode display multimodality when there is an eigenmode with multiple peaks in the eigensapce. Perticuliarly, the first eigenmode appears multimodality when the first and the second eigenvalues are equal. Fig. \ref{fig4}(a) illustrates an example of multimodality. For simplicity, we only focus on the first eigenmode. In two or higher dimension cases, the shape of two subdomains are rarely same, thus the multimodality does not often appear. We mainly discuss the multimodality in one-dimensional case.

For the one-dimensional case, the first eigenmode will localize in the longest extended subdomain. When there are more than one longest extended subdomains, the multimodality occurs on the first eigenmode. As mentioned earlier, length of extended subdomains approximately follow the geometric distribution. The probability that the first eigenmode displays multimodality is equal to the probability that there are more than one longest extended subdomains. When $K$ is sufficiently large, we can calculate the theoretical expression of the probability of the mulimodality. For the Dirichlet boundary condition, we can obtain the probability of multimodality is approximately given by
\begin{equation}\label{multiD}
P_D = 1 - p \sum_{n=1}^{\infty} (1 - p^{n-1})^{M-2} q^{n-1},
\end{equation}
and for the Neumann boundary condition, probability of multimodality is approximately given by equation (see Appendix \ref{appB} for the detailed derivation)
\begin{equation}\label{multiN}
\begin{split}
P_N = 1 - & q^2 (M-2) \sum_{n=1}^{\infty} (1 - q^{(n-1)/2})^2 (1 - q^{n-1})^{M-3} q^{n-1} p \\
- & 2 q^2 \sum_{n=1}^{\infty} (1 - q^{2n-1})^{M-2} (1 - q^{n-1}) q^{n-1} p \\
- & 2 p q (M-1) \sum_{n=1}^{\infty} (1 - q^{(n-1)/2}) (1 - q^{n-1})^{M-2} q^{n-1} p \\
- & 2 p q \sum_{n=1}^{\infty} (1 - q^{2n-1})^{M-1} q^{n-1} p \\
- & p^2 M \sum_{n=1}^{\infty} (1 - p^{n-1})^{M-1} q^{n-1} p.
\end{split}
\end{equation}

On the one hand, the eigenvalues are exactly equal only if $K \rightarrow \infty$, but we can only choose $K$ as a large number in simulation. On the ohter hand, the simulation will be affected by calculation error. Thus we can hardly observe that eigenvalues are exactly equal in practice. We regard that the eigenvalues are equal when the relative difference between the first and the second eigenvalue satisfy $\frac{\lambda_2 - \lambda_1}{\lambda_1} < 0.02$ and the multimodality appears when there is an eigenmode with multiple peaks in the eigensapce formed by eigenmode $u_1$ and $u_2$.

Fig. \ref{fig4}(b), (c) illustrate the simulation results and theoretical predictions for both Dirichlet and Neumann boundary condition. The theoretical prediction is in good agreement with the simulation. In both Dirichlet and Neumann boundary conditions, the probability of multimodality incerase with $p$. Under different values of $p$, the value of probability $P_D$ and $P_N$ is at most $0.5$, which indicates that multimodality is a common phenomenon in our model.

\begin{figure}
\centering
\includegraphics[width=\linewidth]{Fig4}
\caption{(a) A one-dimensional example of multimodality with the Neumann boundary condition. The gray background denotes $V = 1$ in the subdomain and the white background denotes $0$. The black line denotes the landscape and the colored lines denote the eigenmodes.  Parameter is chosen as $K = 10^4$. In this example, the first and the second eigenvalue are both $\lambda_1 = \lambda_2 = 681.55$. (b), (c) Simulation results and theoretical predictions of the probability of multimodality under the Dirichlet and Neumann boundary condition respectively. Blue crosses denote the frequency of multimodality under different values of $p$, red crosses denote the frequency of the event that there are more than one longest extended subdomains and the black line denotes the theoretical prediction of $P_D$ and $P_N$ obtained from equation \eqref{multiD} and \eqref{multiN}. Parameters are chosen as $K = 3 \times 10^6, N = 50$. We randomly generate the potential $1000$ times on each point and calculate the mean value of the samples as the results of the probability.}
\label{fig4}
\end{figure}

\section{Phase transition}

\subsection{Model of phase transition}

According to the previous discussion, when $K$ is large, the first eigenmode of the system will localize to the longest subinterval on which $V(x) = 0$. But, as shown in Fig. \ref{fig5}(b), when $K$ is not large enough, the first eigenmode may localize to otherwhere. This phenomenon may occur under various boundary conditions. A natural problem is, as $K$ increases, how does the localization behavior of the system transfer from one to another?

Here we consider a toy model in one-dimensional case with parabolic boundary condition. In this model, the potential $V$ is chosen as follows. As shown in Fig. \ref{fig5}(a), in the whole domain $[0, 1]$, the values of $V$ are $0$ and $1$ alternately in these intervals with length $L_2/2, L_1, L_2, L_3, L_4, L_3, L_2/2$ respectively.
\begin{equation*}
V = \left\{
\begin{split}
1 & \quad x \in [0, x_1), \\
0 & \quad x \in [x_1, x_2), \\
1 & \quad x \in [x_2, x_3), \\
0 & \quad x \in [x_3, x_4), \\
1 & \quad x \in [x_4, x_5), \\
0 & \quad x \in [x_5, x_6), \\
1 & \quad x \in [x_6, 1].
\end{split}
\right.
\qquad
\text{where}
\qquad
\left\{
\begin{split}
x_1 & = L_2/2, \\
x_2 & = L_2/2 + L_1, \\
x_3 & = L_2/2 + L_1 + L_2, \\
x_4 & = L_2/2 + L_1 + L_2 + L_3, \\
x_5 & = L_2/2 + L_1 + L_2 + L_3 + L_4, \\
x_6 & = L_2/2 + L_1 + L_2 + L_3 + L_4 + L_3.
\end{split}
\right.
\end{equation*}

The potential can be viewed as two wells with lengths $L_1$ and $2 L_3$ respectively, while there is a barrier with a small length $L_4$ in the middle of the right well. The distance between the two wells is $L_2$. We define the interval $W_1 = [x_1, x_2]$ and the interval $W_2 = [x_3, x_5]$ to relpresent the left and the right well respectively. The phase transition problem can be described as
\begin{equation}
S: \;
\left\{
\begin{split}
& -\triangle u + K V u = \lambda u, \quad \textrm{in} \; (0, 1), \\
& u(0) = u(1), \quad u'(0) =  u'(1).
\end{split}
\right.
\end{equation}

In the phase transition problem, the distance between the two wells should be large enough to separate two wells and ensure there are little influence between the two wells. The length of barrier should be small and the length of $W_2$ and $W_1$ should be approximately equal, which can ensure the occurance of phase transition phenomon. In particular, the parameters should satisfy: $L_3 < L_1$ (ensure the first eigenmode localize to $W_1$ when $K$ is large), $L1 < 2 L_3$ (ensure the first eigenmode localize to $W_2$ when $K$ is small), $L_4 < L_3 / 2$ (barrier should be short enough), $L_2 > L_1 + 2 L_3 + L_4$ (two wells should be far enough), and $L_1 + 2 L_2 + 2 L_3 + L_4 = 1$ (the total length equals $1$).

The first and the second eigenmodes of the problem under different values of $K$ are illustrated in Fig. \ref{fig5}(b). Since the second well $W_2$ is longer, when $K$ is small, the barrier in $W_2$ is not strong enough, and then the first eigenmode will localize to $W_2$. On the contrary, when $K$ is large, the first eigenmode will localize to $W_1$. As the parameter $K$ increases, the left peak of the first eigenmode becomes higher and the right peak vanishes. Then the location of the maxima of the first eigenmode will transfer from $W_2$ to $W_1$, and \emph{phase transition} occurs.
% Due to the orthogonality, the behavior of the second eigenmode is the opposite of the first, location of the maxima of the second eigenmode will transfer from $W_1$ to $W_2$.

In particular, we define the relative height of the left peak of a certain eigenmode $u$ as 
\begin{equation}
F = \frac{\max_{x \in W_1} |u(x)|}{\max_{x \in W_1} |u(x)| + \max_{x \in W_2} |u(x)|}.
\end{equation}
In general, the relative height $F$ of the first eigenmode increases with $K$. Fig. \ref{fig5}(c) illustrates the variation of the relative height $F$ of the first eigenmode with the parameter $K$. As $K$ increases, $F$ will change from around $0$ to around $1$ when $K$ reaches a critical threshold, corresponding to the occurrence of phase transition. There exists a value of $K$ satisfy the left peak and the right peak of $u_1$ are equal in height, that is $F = 0.5$. The value of $K$ which satisfy $F = 0.5$ is defined as the \emph{critical threshold} of phase transition, which is denoted by $K_c$.

In the phase transition problem, the potential has two wells. When $L_2$ is large enough, the two wells are so far apart that they have little influence on each other. Thus, we can divide the problem $S$ into two subsystems $S_1, S_2$ and discuss the eigenmode localizing to $W_1$ and $W_2$ separately. As shown in Fig. \ref{fig5}(a), set the value of $V(x)$ in $W_1$ to $1$, and we can obtain $V_2(x)$. Similarly, set the value in $W_2$ to $1$, and we can obtain $V_1(x)$.
\begin{equation*}
V_1 = \left\{
\begin{split}
1 & \quad x \in [0, x_1), \\
0 & \quad x \in [x_1, x_2), \\
1 & \quad x \in [x_2, 1].
\end{split}
\right.
\qquad
\text{and}
\qquad
V_2 = \left\{
\begin{split}
1 & \quad x \in [0, x_3), \\
0 & \quad x \in [x_3, x_4), \\
1 & \quad x \in [x_4, x_5), \\
0 & \quad x \in [x_5, x_6), \\
1 & \quad x \in [x_6, 1].
\end{split}
\right.
\end{equation*}
The original system $S$ can be decomposed into two subsystems $S_1$ and $S_2$ with potential $V_1(x)$ and $V_2(x)$ separately.
\begin{equation}
S_i: \;
\left\{
\begin{split}
& -\triangle u + K V_i u = \lambda u, \quad \textrm{in} \; (0, 1), \\
& u(0) = u(1), \quad u'(0) =  u'(1).
\end{split}
\right.
\quad
i = 1, 2.
\end{equation}
For the first two eigenmodes, the eigenmode localized to $W_1$ can be approximated by the first eigenmode of subsystem $S_1$, and the other eigenmode can be approximated by the first eigenmode of $S_2$.  Fig. \ref{fig5}(d) illustrates the first two eigenmodes of the original system $S$ and the first eigenmode of two subsystems. It can be seen from the figure that the eigenmode of each subsystem are almost the same as the eigenmode of the original system in the corresponding well. Fig. \ref{fig5}(e) illustrates the eigenvalues of the original system and subsystems under different values of $K$. The eigenvalues of the subsystems are good approximations to the eigenvalues of the original system.

Now we can give some detailed explanation for the occurrence of phase transition. The eigenvalue of each subsystem increases with the increasing of $K$, but eigenvalues of both subsystems increase at different rates, corresponding to the two lines with different slopes in Fig. \ref{fig5}(e). When $K$ is small, the eigenvalue of $S_2$ is smaller. Then the subsystem $S_2$ is dominant, and the first eigenmode of $S$ will localize to $W_2$. As the parameter $K$ increases, the eigenvalue of $S_1$ will exceed the eigenvalue of $S_2$. At that time, the localization of the first eigenmode of $S$ will change from $W_2$ to $W_1$, which means that phase transition occurs. Similar to the multimodality, phase transition occurs when the first and the second eigenvalues of the original system $S$ are approximately equal, which means that the first eigenvalues of both subsystems are approximately equal. The value of the first eigenvalue when phase transition occur is defined as the critical eigenvalue and is denoted by $\lambda_c$.

\begin{figure}
\centering
\includegraphics[width=\linewidth]{Fig5}
\caption{(a) Potentials mentioned in the phase transition problem. Blue parts denote subdomains on which $V = 0$ and yellow parts denote $V = 1$. (b) The first eigenmode $u_1$ and the second eigenmode $u_2$ under different values of $K$ in the phase transition problem. (c) The relative height $F$ of the first eigenmode $u_1$ under different values of $K$. The black dotted line denotes the line $F = 0.5$ and the red circle denotes the critical threshold. (d), (e) Eigenmodes and eigenvalues of the original system $S$ and two subsystems $S_1$ and $S_2$ respectively. We choose the parameter $K = 800$ in (d). Parameters are chosen as $L_1 = 1/12, L_2 = 2/5, L_3= 1/20, L_4 = 1/60$ in all figures.}
\label{fig5}
\end{figure}

\subsection{Determination of the critical threshold and critical eigenvalue}

To get the critical thereshold and the ciritcal eigenvalue, we should solve the system under different values of $K$ many times, which may be time-consuming. Here we give a theoretical expression of the critical thereshold and the ciritcal eigenvalue.

Firstly, we will simplify the subsystems. Consider the subsystem $S_1$, owning to the periodicity, we can shift the potential freely. As shown in Fig. \ref{fig5}(a), we can move the well $W_1$ to the middle of the whole interval without changing the eigenvalues of the subsystem. Eigenvalues of subsystems $S_1$ and $S_2$ is equal to the eigenvalues of systems $\hat{S}_1$ and $\hat{S}_2$ respectively. The potentials of the two systems $\hat{V}_1$ and $\hat{V}_2$ are defined as
\begin{equation*}
\hat{V}_1 = \left\{
\begin{split}
1 & \quad x \in \left[ 0, \frac{1 - L_1}{2} \right), \\
0 & \quad x \in \left[ \frac{1 - L_1}{2}, \frac{1 + L_1}{2} \right), \\
1 & \quad x \in \left[ \frac{1 + L_1}{2}, 1 \right].
\end{split}
\right.
\qquad
\text{and}
\qquad
\hat{V}_2 = \left\{
\begin{split}
1 & \quad x \in \left[ 0, \frac{1 - L_4 - 2 L_3}{2} \right), \\
0 & \quad x \in \left[ \frac{1 - L_4 - 2 L_3}{2}, \frac{1 - L_4}{2} \right), \\
1 & \quad x \in \left[ \frac{1 - L_4}{2}, \frac{1 + L_4}{2} \right), \\
0 & \quad x \in \left[ \frac{1 + L_4}{2}, \frac{1 + L_4 + 2 L_3}{2} \right), \\
1 & \quad x \in \left[ \frac{1 + L_4 + 2 L_3}{2}, 1 \right].
\end{split}
\right.
\end{equation*}

Due to the symmetry, noting that both potential $\hat{V}_i$ satisfy $\hat{V}_i(x) = \hat{V}_i(1-x), \ i = 1, 2$, thus the eigenmodes of $\hat{S}_i$ should also satisfy $u(x) = u(1-x)$ and $u'(x) = -u'(1-x)$. Taking $x = 1/2$ we can obtain $u'(1/2)=0$ and taking $x = 0$, using the periodic boundary condition $u'(0) = u'(1)$ we can obtain $u'(0) =0$. Then, the eigenvalues of the systems are equal to the eigenvalues of the problems defined on interval $[0, 1/2]$ with the Neumann boundary condition, whose potential $\tilde{V}_i$ is defined as
\begin{equation*}
\tilde{V}_i(x) = \hat{V}_i(x) \qquad x \in [0, 1/2], \quad i = 1, 2.
\end{equation*}
The problems are
\begin{equation}
\tilde{S}_i: \;
\left\{
\begin{split}
& -\triangle u + K \tilde{V}_i u = \lambda u, \quad \textrm{in} \; (0, 1/2), \\
& u'(0) = u'(1/2) = 0
\end{split}
\right.
\quad
i = 1, 2.
\end{equation}
After simplified, the eigenvalues of the subsystems $S_1$ and $S_2$ are equal to the eigenvalues of $\tilde{S}_1$ and $\tilde{S}_2$ respectively. The potentials $\tilde{V}_1$ and $\tilde{V}_2$ are also shown in Fig. \ref{fig5}(a).

After the above simplification, for certain value of $K$, each eigenvalue $\lambda$ of subsystem $S_1$ and $S_2$ satisfies the equation (see Appendix \ref{appC} for the detailed derivation)
\begin{equation}\label{phase1}
0 = D_1(K, \lambda) = \alpha \tan(\alpha t_0) - \beta \tanh(\beta (1/2 - t_0)),
\end{equation}
and
\begin{equation}\label{phase2}
\begin{split}
0 = D_2(K, \lambda) = & (\alpha^2 - \beta^2)(\mathrm{e}^{2 \beta t_2} + \mathrm{e}^{2 \beta (t_1+t_3)}) / (\mathrm{e}^{2 \beta (t_1+t_3)} - \mathrm{e}^{2 \beta t_2}) \\
& + (\alpha^2 + \beta^2)(\mathrm{e}^{2 \beta t_3} + \mathrm{e}^{2 \beta (t_1+t_2)}) / (\mathrm{e}^{2 \beta (t_1+t_3)} - \mathrm{e}^{2 \beta t_2}) \\
& + 2 \alpha \beta \cot(\alpha (t_1 - t_2))
\end{split},
\end{equation}
where $\alpha = \sqrt{\lambda}, \beta = \sqrt{K - \lambda}, t_0 = L_1 / 2, t_1 = L_4 / 2, t_2 = L_4 / 2 + L_3, t_3 = 1 / 2$.

When phase transition occurs, the first eigenvalues of the both subsystems are approximately equal. Then the critical threshold $K_c$ and the critical eigenvalue $\lambda_c$ satisfy
\begin{equation}\label{phase0}
\left\{
\begin{split}
D_1(K_c, \lambda_c) = 0 \\
D_2(K_c, \lambda_c) = 0
\end{split}
\right.
\end{equation}
This system of algebraic equations can be used to analytically predict the critical threshold and the critical eigenvalue of the problem. Here, we can avoid the time-consuming simulations.

To validate our theory, we generate $L_1, L_2, L_3, L_4$ randomly as our sample points. On $1000$ sample points, mean square error (MSE) of the critical threshold $K_c$ is $0.3947$, and MSE of the critical eigenvalue $\lambda_c$ is $9.1751$. The predicted values obtained from \eqref{phase0} are very close to the simulation results.

Noting that there are two descriptions of the critical threshold $K_c$ mentioned above. One is that two peaks of the first eigenmode locates in $W_1$ and $W_2$ are equal in height ($F = 0.5$) and the other is that the first and the second eigenvalues of the original system are equal ($\lambda_1 = \lambda_2$). Actually, the two descriptions are not exactly same, which gives rise to the error mentioned above. The simulation results demonstrate that the difference between two descriptions is sufficient small and in general can be neglected.

\subsection{Key factors in phase transition}

Clearly, the critical threshold $K_c$ depends on four variables $L_1$, $L_2$, $L_3$ and $L_4$, but the relationship between them is very complicated. Here we simplify the relationship with some approximation and point out the key factors. 

Since there is a restriction of total length $L_1 + 2 L_2 + 2 L_3 + L_4 = 1$, there are only three degrees of freedom. We can define 
\begin{equation}
P_1 = \frac{1 - 2 L_2}{L_1 + 2 L_2 + 2 L_3 + L_4}, \quad P_2 = \frac{L_1}{L_1 + 2 L_3 + L_4}, \quad P_3 = \frac{L_4}{2 L_3 + L_4},
\end{equation}
where $P_1$ represents the total length of the two wells, $P_2$ represents the proportion of the length of $W_1$ to the total length and $P_3$ represents the proportion of the length of barrier in $W_2$ to the total length of $W_2$.

The relationship between $K_c$ and the factors $P_1$, $P_2$, $P_3$ is complicate, but we can obtain the relationship by the analytical theroy and some numerical simulations approximately. Fig. \ref{fig6} illustrates the variation of the critical threshold $K_c$ with the factor $P_1$, $P_2$ and $P_3$ respectively. In numerical simulations shown in Fig. \ref{fig6}(a), we generate different values of $P_1$ uniformly in an certain range and keep the other two variables invariant. Fig. \ref{fig6}(b,c) are obatined similiarly.

In particular, the relationship between $K_c$ and $P_1$ can be expressed as
\begin{equation}
K_c = C_1 {P_1}^{\alpha_1},
\end{equation}
where $C_1$ and $\alpha_1$ are constants independent of $P_1$. The results obtained from linear regression is $\alpha_1 = -2.0004$ and the coefficient of determination between $K_c$ and $P_1$ is $R^2 = 1 - 1.6 \times 10^{-8}$, which indicates that $K_c$ is approximaltly a power law function of $P_1$ with exponent $-2$.

Similarly, we can obtain the relationship between $K_c$ and $P_2$, $P_3$ are
\begin{equation}
K_c = \exp(C_2 P_2 + C_3),
\end{equation}
and
\begin{equation}
K_c = C_4 {P_3}^{\alpha_2}.
\end{equation}
The linear regression result is $\alpha_2 = -1.6968$. The coefficient of determination between $K_c$ and $P_2$ is $R^2 = 1 - 4.1 \times 10^{-3}$ and the coefficient of determination between $K_c$ and $P_3$ is $R^2 = 1 - 3.3 \times 10^{-3}$.

From the results we can see that the critical threshold $K_c$ are power law functions of both $P_1$ and $P_3$, while $K_c$ is an exponential function of $P_2$. This means that the proportion of the length of two wells is more important than other factors in phase transition problems. Moreover, the exponent of $P_1$ is $-2$ and the exponent of $P_3$ is $-1.7$. This means that the influence of the total length of the two wells on $K_c$ is much stronger.

\begin{figure}
\centering
\includegraphics[width=\linewidth]{Fig6}
\caption{The relationship between the critical threshold $K_c$ and the factors $P_1$, $P_2$, and $P_3$. Blue circles denote the simulation results and the red lines denote the results obtained by linear regression. Default parameters are chosen as $P_1 = 0.25, P_2 = 0.4, P_3 = 0.1$ if not mentioned. In each subfigure, we genreate $12$ sample points uniformly in the certain range.}
\label{fig6}
\end{figure}

\section{Conclusion}

In this paper, we firstly proposed the landscape of the Anderson Localization problem with arbitary second-order elliptic differential operator and arbitary open bounded condition using the Skorokhod stochastic differential equation. Basing on the Skorokhod equation, we discussed the limit behavior of the landscape and the eigenmode of the problem for large degree of randomness. Secondly, we found out the boundary localization and the multimodality phenomon and calculated the probability of the occurance of these phenomon theoretically in one-dimionsional case. The theoretical prediction is in perfect agreement with the numerical simulation. Finally, we calculated the theoretical expression of the critical thereshold in phase transition model and pointed out the key factors which has the most influence of the critical thereshold.

\section*{Acknowledgements}
The authors acknowledge support from the NSAF grant in National Natural Science Foundation of China (NSFC) with grant No. U1930402.

\setlength{\bibsep}{5pt}
\small\bibliographystyle{nature}
\bibliography{localization}

\normalsize
\begin{appendices}

\section{Proof of the Filochea-Mayboroda inequality}\label{appA}

Let $(X, F)$ be the solution to the Skorokhod stochastic differential equation
\begin{equation*}
d X_t = b(X_t) dt + \sigma(X_t) d W_t - g(X_t) n(X_t) d F_t,
\end{equation*}
where $F$ is a continuous increasing process that increases when $X_t \in \partial \Omega$. For convenience, let
\begin{equation*}
Y_t = e^{\int_{0}^{t} h(X_s) d F_s - \int_{0}^{t} K V(X_s) ds}.
\end{equation*}
By Ito's formula, we have
\begin{equation*}
\begin{split}
du(X_t) Y_t = & u(X_t) Y_t [h(X_t) dF_t - K V(X_t) dt] + \partial_i u(X_t) Y_t dX^i_t + \frac{1}{2} \partial_{ij} u(X_t) Y_t (dX^i_t) (dX^j_t) \\
= & u(X_t) Y_t [h(X_t) dF_t - K V(X_t) dt] + \partial_i u(X_t) b^i(X_t) Y_t dt + \partial_i u(X_t) \sigma^i_j(X_t) Y_t dW^j_t \\
& + \partial_i u(X_t) g(X_t) n^i(X_t) Y_t dF_t + \frac{1}{2} \partial_{ij} u(X_t) a^{ij}(X_t) Y_t dt\\
= & \partial_i u(X_t) \sigma^i_j(X_t) Y_t dW^j_t + (L u - K V u) (X_t) Y_t dt
+\left( g \frac{\partial u}{\partial n} + h u \right) (X_t) Y_t dF_t,
\end{split}
\end{equation*}
where we have used Einstein's summation convention: if the same index appears twice in any term, once as an upper index and once as a lower index, that term is understood to be summed over all possible values of that index. Since $F_t$ only increases when $X_t \in \partial \Omega$ and since $g \partial u/\partial n + h u = 0$ on $\partial \Omega$, we obtain
\begin{equation*}
du(X_t) Y_t = \partial_i u(X_t) \sigma^i_j(X_t) Y_t dW^j_t - \lambda u(X_t) Y_tdt.
\end{equation*}
This shows that
\begin{equation*}
u(X_t)Y_t = u(X_0) + \int_0^t \partial_i u(X_s) \sigma^i_j(X_s) Y_s dW^j_s - \lambda \int_0^t u(X_s) Y_s ds.
\end{equation*}
Thus we have
\begin{equation*}
u(x) = \Enum_xu(X_t)Y_t+\lambda\Enum_x\int_0^t u(X_s)Y_sds.
\end{equation*}
Taking $t\rightarrow\infty$ in the above equation yields
\begin{equation*}
u(x) = \lambda\Enum_x\int_0^\infty u(X_s)Y_sds.
\end{equation*}
Recall that the localization landscape $w = w(x)$ is defined as the solution to the following PDE:
\begin{equation*}
\left\{
\begin{split}
& - L w + K V w = 1 \quad \textrm{in} \; \Omega, \\
& \quad g \frac{\partial w}{\partial n} + h w = 0 \quad \textrm{on} \; \partial \Omega,
\end{split}\right.
\end{equation*}
Similarly, the landscape has the following probabilistic representation:
\begin{equation*}
w(x) = \Enum_x\int_0^\infty Y_sds.
\end{equation*}


\section{Proof of the extended subdomain}\label{appD}

Consider $D \subset \Omega \subset \Rnum^n$ is an open set in $n$-dimensional space, where $\Omega$ is the intersection of some half-spaces.
$$ \Omega = \{\bx = (x_1, x_2, \cdots, x_n) \in \Rnum^n \, : \, x_1, x_2, \cdots, x_d > 0\} \quad \text{where} \quad 0 < d \leq n. $$
$D^{(e)}$ is mirror symmetrical of $D$ about the corresponding hyper-plane,
$$ D^{(e)} = \mathrm{int}(\overline{D^{(e)}_0}) \quad \text{where} \quad D^{(e)}_0 = \{\bx \in \Rnum^n \, : \, \tau \bx \in D \}. $$
where the symmetric operator
$$ \tau (x_1, x_2, \cdots, x_n) = (|x_1|, |x_2|, \cdots, |x_d|, x_{d+1}, \cdots, x_n). $$

Consider the first eigenvalue and eigenmode for two eigenvalue problems in $D$ and $D^{(e)}$ respectively. The eigenvalue problem in $D$ is
\begin{equation}\label{eigenD}
\left\{
\begin{split}
& -\triangle u = \lambda u, & \quad \text{for} \; \bx \in D, \\
& \quad u = 0, & \quad \text{for} \; \bx \in \partial D \setminus \partial \Omega, \\
& \quad \frac{\partial u}{\partial \mathbf{n}} = 0, & \quad \text{for} \; \bx \in \partial D \cap \partial \Omega.
\end{split}
\right.
\end{equation}
The eigenvalue problem in $D^{(e)}$ is
\begin{equation}\label{eigenDe}
\left\{
\begin{split}
& -\triangle u = \lambda u, & \quad \text{for} \; \bx \in D^{(e)}, \\
& \quad u = 0, & \quad \text{for} \; \bx \in \partial D^{(e)}.
\end{split}
\right.
\end{equation}

Function $u(\bx)$ defined on $D$ and $\lambda$ is the first eigenpair of problem \eqref{eigenD}. Then we can obtain $u^{(e)}$ from $u$ through mirror symmetry.
\begin{equation*}
u^{(e)}(\bx) = u(\bx) \;\; \text{for} \;\; \bx \in D, \quad \text{and} \quad u^{(e)}(\bx) = u(\tau \bx) \;\; \text{for} \;\; \bx \in D^{(e)} \setminus D.
\end{equation*}
Under such defination, $u^{(e)}$ is sufficient smooth on $D^{(e)}$.

For $\bx \in D$, we have
\begin{equation*}
-\triangle u^{(e)}(\bx) = -\triangle u(\bx) = \lambda u(\bx) = \lambda u^{(e)}(\bx),
\end{equation*}
and for $\bx \in D^{(e)} \setminus D$, we have
\begin{equation*}
-\triangle u^{(e)}(\bx) = -\triangle u(\tau \bx) = -\triangle u(\bx) = \lambda u(\bx) = \lambda u(\tau \bx) = \lambda u^{(e)}(\bx).
\end{equation*}
Then the function $u^{(e)}$ satisfies the interior equation of problem \eqref{eigenDe} almost everywhere.

Obviously, the function $u^{(e)}$ also satisfies the boundary condition. Then $u^{(e)}$ and $\lambda$ is one of eigenpairs of problem \eqref{eigenDe}.

According the results in \cite{2012Geometrical}, the first eigenmode of the laplacian eigenvalue problem does not change its sign. The eigenmode $u$ can be choosen as $u(\bx) > 0$ and we have $u^{(e)}(\bx) > 0$. Because of the orthogonality of eigenmodes, the first eigenmode is the only eigenmode not changing its sign. Then we can get $u^{(e)}(\bx)$ is the first eigenmode of problem \eqref{eigenDe}.

\section{Geometry distribution approximation}\label{appB}

Consider the whole interval $[0, 1]$ is divided uniformly into $N$ subintervals. In each subinterval, the potential $V$ is sampled from the Bernoulli distribution. The values of the potential in different subintervals are independent of each other.

Suppose that the previous two intervals on which $V$ takes the value $1$ and $0$ respectively. Then the number of following intervals on which $V$ takes the value $0$ is a random variable $X$. $X$ takes the value $n$ means that the values of $V$ on the next $n-1$ intervals are $0$ and the value on the next $n$-th is $1$. For a sufficient large $N$, the random variable $X$ approximately obeys the geometric distribution with parameter $p$. This means that
$$ \mathbb{P}(X = n) = q^{n-1} p, $$
where $q = 1 - p$.

Similarly, the number of continuous intervals on which $V$ takes the value $1$ is also a random variable $Y$ with distribution
$$ \mathbb{P}(Y = n) = p^{n-1} q. $$

In the whole domain $[0, 1]$, subdomains on which $V = 0$ and $V = 1$ must appear alternately. Two adjacent subdomains are called a \emph{period}. The average length of each period is $\Enum(X + Y) = \frac{1}{p q}$. Therefore, the average number of periods in the whole domain is $M = N p q$. We can approximately assume that the whole domain consists of subdomains taking values $0$ and $1$ alternately with length $X_1, Y_1, \cdots, X_M, Y_M$. For a sufficient large $N$, the random variables $X_1, Y_1, \cdots, X_M, Y_M$ are approximately independent.

Let random variables $X_1, Y_1, \cdots, X_M, Y_M$ are independent, with distribution
$$ \mathbb{P}(X_k = n) = q^{n-1} p \quad \mathbb{P}(Y_k = n) = p^{n-1} q \qquad k = 1, 2, \cdots, M, $$
thus
$$ \mathbb{P}(X_k < n) = 1 - q^{n-1}, $$
where $q = 1 - p$ and $M = N p q$.

\subsection{Calculation of \eqref{bdprob}}\label{appB1}

For the Neumann boundary conditions, event "the longest extended subdomain appears on the boundary" can be divided into the following situations:

\paragraph*{situation 1}
$V(0) = V(1) = 0$ with probability $q^2$. Under such conditions, length of extended subdomains are $2 X_1, X_2, \cdots, X_{M-1}, 2 X_M$.

Then we have
\begin{equation*}
\begin{split}
  & \mathbb{P}(\text{the longest extended subdomain appears on the boundary}) \\
= & \mathbb{P}(\max\{X_2, X_3, \cdots, X_{M-1}\} < 2 \max\{X_1, X_M\}) \\
= & \sum_{m,n=1}^{\infty} \mathbb{P}(\max\{X_2, X_3, \cdots, X_{M-1}\} < 2 \max\{m,  n\}) \mathbb{P}(X_1 = m) \mathbb{P}(X_M = n) \\
= & \sum_{m,n=1}^{\infty} [\mathbb{P}(X_k < 2 \max\{m,n\}) ]^{M-2} \mathbb{P}(X_1 = m) \mathbb{P}(X_M = n)\\
= & \sum_{m,n=1}^{\infty} (1 - q^{2 \max\{m,n\}-1})^{M-2} q^{m-1} p q^{n-1} p\\
= & \sum_{k=1}^{\infty} q^{k-2} p^2 \sum_{n=1}^{k-1} (1 - q^{2 \max\{k-n,n\}-1})^{M-2} 
\end{split}.
\end{equation*}

\paragraph*{situation 2}
$V(0) = 0, V(1) = 1$ with probability $p q$. Under such conditions, length of extended subdomains are $2 X_1, X_2, \cdots, X_M$.

Then we have
\begin{equation*}
\begin{split}
  & \mathbb{P}(\text{the longest extended subdomain appears on the boundary}) \\
= & \mathbb{P}(\max\{X_2, X_3, \cdots, X_{M}\} < 2 X_1) \\
= & \sum_{n=1}^{\infty} \mathbb{P}(\max\{X_2, X_3, \cdots, X_{M-1}\} < 2 n) \mathbb{P}(X_1 = n) \\
= & \sum_{n=1}^{\infty} [\mathbb{P}(X_k < 2 n)]^{M-1} \mathbb{P}(X_1 = n)\\
= & q \sum_{n=1}^{\infty} (1 - p^{2 n-1})^{M-2} p^{n-1}
\end{split}.
\end{equation*}

\paragraph*{situation 3}
$V(0) = 1, V(1) = 0$ with probability $p q$. Under such conditions, length of extended subdomains are $2 X_1, X_2, \cdots, X_M$. It can be calculated similarly to situation 2.

In summary, probability of localize to the boundary is
\begin{equation*}
P_b = q^2 p^2 \sum_{k=1}^{\infty} q^{k-2} \sum_{n=1}^{k-1} (1 - q^{2 \max\{k-n,n\}-1})^{M-2} + p q^2 \sum_{n=1}^{\infty} (1 - p^{2 n-1})^{M-2} p^{n-1}.
\end{equation*}

\subsection{Calculation of \eqref{multiD}}\label{appB2}

For the Dirichlet Boundary, we have
\begin{equation*}
\begin{split}
P_D = & \mathbb{P}(\text{there is a unique longest subdomain}) \\
= & \sum_{k=1}^{M} \mathbb{P}(\max\{X_1, X_2, \cdots, X_{k-1}, X_{k+1}, \cdots, X_{M}\} < X_k) \\
= & M \; \mathbb{P}(\max\{X_{2}, X_{3}, \cdots, X_{M}\} < X_1) \\
= & M \sum_{n=1}^{\infty} \mathbb{P}(\max\{X_2, X_3, \cdots, X_{M-1}\} < n) \mathbb{P}(X_1 = n) \\
= & M \sum_{n=1}^{\infty} [\mathbb{P}(X_k < n)]^{M-1} \mathbb{P}(X_1 = n)\\
= & M \sum_{n=1}^{\infty} (1 - p^{n-1})^{M-1} q^{n-1} p
\end{split}.
\end{equation*}

\subsection{Calculation of \eqref{multiN}}\label{appB3}

For the Neumann Boundary, probability of "there is a unique longest extended subdomain" can be divided into the following situations:

\paragraph*{situation 1}
$V(0) = V(1) = 0$ with probability $q^2$. We have
\begin{equation*}
\begin{split}
  & \mathbb{P}(\text{there is a unique longest subdomain}) \\
= & \sum_{k=2}^{M-1} \mathbb{P}(\max\{2 X_1, X_2, \cdots, X_{k-1}, X_{k+1}, \cdots, 2 X_{M}\} < X_k) \\
& + \mathbb{P}(\max\{X_2, \cdots, X_{M-1}, 2 X_M\} < 2 X_1) \\
& + \mathbb{P}(\max\{2 X_1, X_2, \cdots, X_{M-1}\} < 2 X_M) \\
= & (M-2) \mathbb{P}(\max\{2 X_1, X_3 \cdots, 2 X_{M}\} < X_2) \\
& + 2 \mathbb{P}(\max\{X_2, \cdots, X_{M-1}, 2 X_M\} < 2 X_1) \\
= & (M-2) \sum_{n=1}^{\infty} \mathbb{P}(\max\{2 X_1, X_3 \cdots, 2 X_{M}\} < n) \mathbb{P}(X_2 = n) \\
& + 2 \sum_{n=1}^{\infty} \mathbb{P}(\max\{X_2, \cdots, X_{M-1}, 2 X_M\} < 2 n) \mathbb{P}(X_1 = n) \\
= & (M-2) \sum_{n=1}^{\infty} [\mathbb{P}(2 X_k < n)]^2 [\mathbb{P}(X_k < n)]^{M-3} \mathbb{P}(X_2 = n) \\
& + 2 \sum_{n=1}^{\infty} [\mathbb{P}(X_k < 2 n)]^{M-2} \mathbb{P}(X_k < n) \mathbb{P}(X_1 = n) \\
= & (M-2) \sum_{n=1}^{\infty} (1 - q^{(n-1)/2})^2 (1 - q^{n-1})^{M-3} q^{n-1} p \\
& + 2 \sum_{n=1}^{\infty} (1 - q^{2n-1})^{M-2} (1 - q^{n-1}) q^{n-1} p
\end{split}.
\end{equation*}

\paragraph*{situation 2}
$V(0) = 0, V(1) = 1$ with probability $p q$. We have
\begin{equation*}
\begin{split}
  & \mathbb{P}(\text{there is a unique longest subdomain}) \\
= & \sum_{k=2}^{M} \mathbb{P}(\max\{2 X_1, X_2, \cdots, X_{k-1}, X_{k+1}, \cdots, X_{M}\} < X_k) \\
& + \mathbb{P}(\max\{X_2, \cdots, X_{M-1}, X_M\} < 2 X_1) \\
= & (M-1) \mathbb{P}(\max\{2 X_1, X_3 \cdots, X_{M}\} < X_2) \\
& + \mathbb{P}(\max\{X_2, \cdots, X_{M-1}, X_M\} < 2 X_1) \\
= & (M-1) \sum_{n=1}^{\infty} \mathbb{P}(\max\{2 X_1, X_3 \cdots, X_{M}\} < n) \mathbb{P}(X_2 = n) \\
& + \sum_{n=1}^{\infty} \mathbb{P}(\max\{X_2, \cdots, X_{M-1}, X_M\} < 2 n) \mathbb{P}(X_1 = n) \\
= & (M-1) \sum_{n=1}^{\infty} \mathbb{P}(2 X_k < n) [\mathbb{P}(X_k < n)]^{M-2} \mathbb{P}(X_2 = n) \\
& + \sum_{n=1}^{\infty} [\mathbb{P}(X_k < 2 n)]^{M-1} \mathbb{P}(X_1 = n) \\
= & (M-1) \sum_{n=1}^{\infty} (1 - q^{(n-1)/2}) (1 - q^{n-1})^{M-2} q^{n-1} p \\
& + \sum_{n=1}^{\infty} (1 - q^{2n-1})^{M-1} q^{n-1} p
\end{split}.
\end{equation*}

\paragraph*{situation 3}
$V(0) = 1, V(1) = 0$ with probability $p q$. It can be calculated similarly to situation 2.

\paragraph*{situation 4}
$V(0) = 1, V(1) = 1$ with probability $p^2$. It can be calculated similarly to the Dirichlet boundary condition.

In summary, probability of multimodality on the Neumann boundary condition is
\begin{equation*}
\begin{split}
P_N = 1 - & q^2 (M-1) \sum_{n=1}^{\infty} (1 - q^{(n-1)/2}) (1 - q^{n-1})^{M-2} q^{n-1} p \\
- & 2 q^2 \sum_{n=1}^{\infty} (1 - q^{2n-1})^{M-1} q^{n-1} p \\
- & 2 p q (M-1) \sum_{n=1}^{\infty} (1 - q^{(n-1)/2}) (1 - q^{n-1})^{M-2} q^{n-1} p \\
- & 2 p q \sum_{n=1}^{\infty} (1 - q^{2n-1})^{M-1} q^{n-1} p \\
- & p^2 M \sum_{n=1}^{\infty} (1 - p^{n-1})^{M-1} q^{n-1} p
\end{split}.
\end{equation*}

\section{Calculation of \eqref{phase1} and \eqref{phase2}}\label{appC}

\subsection{subsystem on $W_1$}

Consider an one-dimensional eigenvalue problem with Neumann boundary condition in $[0, 1/2]$. In the interval $[0, t_0]$, $V$ takes the value $1$ and in $[t_0, 1/2]$ takes $0$, where $t_0 = L_1/2$.

We define $\alpha = \sqrt{\lambda}, \beta = \sqrt{K - \lambda}$. in the interval $[0, t_0]$, the eigenmode can be written as
\begin{equation*}
u(x) = A \sin(\alpha x) + B \cos(\alpha x) \qquad u'(x) = A \alpha \cos(\alpha x) - B \alpha \sin(\alpha x),
\end{equation*}
and in the interval $[t_0, 1/2]$,
\begin{equation*}
u(x) = C \exp(\beta x) + D \exp(-\beta x) \qquad u'(x) = C \beta \exp(\beta x) - D \beta \exp(-\beta x),
\end{equation*}
where $A ,B, C, D$ are the parameter to be determined.

According to the Neumann boundary condition and the continuity of the eigenmode, we have
\begin{equation*}
\begin{split}
u'(0) & = A \alpha = 0 \\
u'(1/2) & = C \beta \exp(\beta/2) - D \beta \exp(-\beta/2) = 0 \\
u(t_0) & = A \sin(\alpha t_0) + B \cos(\alpha t_0) = C \exp(\beta t_0) + D \exp(-\beta t_0) \\
u'(t_0) & = A \alpha \cos(\alpha t_0) - B \alpha \sin(\alpha t_0) = C \beta \exp(\beta t_0) - D \beta \exp(-\beta t_0)
\end{split},
\end{equation*}
that is
\begin{equation*}
\begin{split}
\left[\begin{array}{cccc} \alpha & 0 & 0 & 0\\ 0 & 0 & \beta \mathrm{e}^{\frac{\beta}{2}} & - \beta \mathrm{e}^{-\frac{\beta}{2}}\\ \sin\!\left(\alpha t_0\right) & \cos\!\left(\alpha t_0\right) & - \mathrm{e}^{\beta t_0} & - \mathrm{e}^{- \beta t_0}\\ \alpha \cos\!\left(\alpha t_0\right) & - \alpha \sin\!\left(\alpha t_0\right) & - \beta \mathrm{e}^{\beta t_0} & \beta \mathrm{e}^{- \beta t_0} \end{array}\right]
\left[\begin{array}{c} A \\ B \\ C \\ D \end{array}\right]
=
\left[\begin{array}{c} 0 \\ 0 \\ 0 \\ 0 \end{array}\right]
\end{split}.
\end{equation*}

The existence of solutions is equivalent to
\begin{equation*}
\det(A) = \alpha \mathrm{e}^{2 \beta t_0} \sin\!\left(\alpha t_0\right) - \beta \mathrm{e}^{\beta} \cos\!\left(\alpha t_0\right) + \alpha \mathrm{e}^{\beta} \sin\!\left(\alpha t_0\right) + \beta \mathrm{e}^{2 \beta t_0} \cos\!\left(\alpha t_0\right) = 0,
\end{equation*}
that is
\begin{equation*}
D_1(K, \lambda) = \alpha \tan(\alpha t_0) - \beta \tanh(\beta (1/2 - t_0)) = 0.
\end{equation*}

\subsection{subsystem on $W_2$}

Consider the an one-dimensional eigenvalue problem with the Neumann boundary condition in $[0, 1/2]$. In the interval $[0, t_1]$ and $[t_2, 1/2]$, $V$ takes the value $1$ and in $[t_1, t_2]$, $V$ takes $0$, where $t_1 = L_4/2, t_2 = L_4/2 + L_3$.

In the interval $[0, t_1]$, the eigenmode can be written as
\begin{equation*}
u(x) = A \exp(\beta x) + B \exp(-\beta x) \qquad u'(x) = A \beta \exp(\beta x) - B \beta \exp(-\beta x),
\end{equation*}
and in the interval $[t_1, t_2]$,
\begin{equation*}
u(x) = C \sin(\alpha x) + D \cos(\alpha x) \qquad u'(x) = C \alpha \cos(\alpha x) - D \alpha \sin(\alpha x),
\end{equation*}
and in the interval $[t_2, 1/2]$,
\begin{equation*}
u(x) = E \exp(\beta x) + F \exp(-\beta x) \qquad u'(x) = E \beta \exp(\beta x) - F \beta \exp(-\beta x),
\end{equation*}
where $A ,B, C, D, E, F$ are the parameter to be determined.

According to the Neumann boundary condition and the continuity of the eigenmode, we have
\begin{equation*}
\begin{split}
u'(0) & = A \beta - B \beta = 0 \\
u(t_1) & = A \exp(\beta t_1) + B \exp(-\beta t_1) = C \sin(\alpha t_1) + D \cos(\alpha t_1) \\
u'(t_1) & = A \beta \exp(\beta t_1) - B \beta \exp(-\beta t_1) = C \alpha \cos(\alpha t_1) - D \alpha \sin(\alpha t_1) \\
u(t_2) & = C \sin(\alpha t_2) + D \cos(\alpha t_2) = E \exp(\beta t_2) + F \exp(-\beta t_2) \\
u'(t_2) & = C \alpha \cos(\alpha t_2) - D \alpha \sin(\alpha t_2) = E \beta \exp(\beta t_2) - F \beta \exp(-\beta t_2) \\
u'(1/2) & = E \beta \exp(\beta/2) - F \beta \exp(-\beta/2) = 0
\end{split},
\end{equation*}
that is
\begin{equation*}
\begin{split}
\left[\begin{array}{cccccc} 1 & -1 & 0 & 0 & 0 & 0\\ \mathrm{e}^{\beta t_1} & \mathrm{e}^{- \beta t_1} & - \sin\!\left(\alpha t_1\right) & - \cos\!\left(\alpha t_1\right) & 0 & 0\\ \beta \mathrm{e}^{\beta t_1} & - \beta \mathrm{e}^{- \beta t_1} & - \alpha \cos\!\left(\alpha t_1\right) & \alpha \sin\!\left(\alpha t_1\right) & 0 & 0\\ 0 & 0 & \sin\!\left(\alpha t_2\right) & \cos\!\left(\alpha t_2\right) & - \mathrm{e}^{\beta t_2} & - \mathrm{e}^{- \beta t_2}\\ 0 & 0 & \alpha \cos\!\left(\alpha t_2\right) & - \alpha \sin\!\left(\alpha t_2\right) & - \beta \mathrm{e}^{\beta t_2} & \beta \mathrm{e}^{- \beta t_2}\\ 0 & 0 & 0 & 0 & \mathrm{e}^{\frac{\beta}{2}} & - \mathrm{e}^{-\frac{\beta}{2}} \end{array}\right]
\end{split}.
\end{equation*}

The existence of solutions is equivalent to
\begin{equation*}
\begin{split}
& \alpha^2 \mathrm{e}^{2 \beta (t_1 + t_2)}  + \alpha^2 \mathrm{e}^{2 \beta (t_1 + x_{3})} \\
& + \beta^2 \mathrm{e}^{2 \beta (t_1 + t_2)} - \beta^2 \mathrm{e}^{2 \beta (t_1 + x_{3})} \\
& + \alpha^2 \mathrm{e}^{2 \beta t_2}  + \alpha^2 \mathrm{e}^{2 \beta x_{3}} \\
- & \beta^2 \mathrm{e}^{2 \beta t_2} + \beta^2 \mathrm{e}^{2 \beta x_{3}} \\
& + 2 \alpha \beta \mathrm{e}^{2 \beta (t_1 + x_{3})} \cot(\alpha (t_1 - t_2)) - 2 \alpha \beta \mathrm{e}^{2 \beta t_2} \cot(\alpha (t_1 - t_2)) = 0
\end{split},
\end{equation*}
that is
\begin{equation*}
\begin{split}
0 = D_2(K, \lambda) = & (\alpha^2 - \beta^2)(\mathrm{e}^{2 \beta t_2} + \mathrm{e}^{2 \beta (t_1+t_3)}) / (\mathrm{e}^{2 \beta (t_1+t_3)} - \mathrm{e}^{2 \beta t_2}) \\
& + (\alpha^2 + \beta^2)(\mathrm{e}^{2 \beta t_3} + \mathrm{e}^{2 \beta (t_1+t_2)}) / (\mathrm{e}^{2 \beta (t_1+t_3)} - \mathrm{e}^{2 \beta t_2}) \\
& + 2 \alpha \beta \cot(\alpha (t_1 - t_2))
\end{split},
\end{equation*}
where $t_3 = 1/2$.

\end{appendices}

\end{document}
